<h1> Conversations </h1>

<div class="ui list">
  <div class="item">
    <% @conversations.each do |conversation| %>
      <% if conversation.sender_id == current_user.id || conversation.recipient_id == current_user.id %>
        <% if conversation.sender_id == current_user.id %>
          <% recipient = User.find(conversation.recipient_id) %>
        <% else %>
          <% recipient = User.find(conversation.sender_id) %>
        <% end %>
        <%= link_to recipient.email, conversation_messages_path(conversation, num_messages_to_show: 10)%> <br>
        <% last_message = conversation.messages[conversation.messages.length - 1] %>
        <% if last_message.user_id == current_user.id %>
          <div class="text-preview"> You: <%= last_message.content %> </div> <br>
        <% else %>
          <div class="text-preview"> <%= recipient.email %>: <%= last_message.content %> </div> <br>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
